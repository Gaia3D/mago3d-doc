# mago3D API 가이드

## 소개(Introduction)

### mago3D란?
mago3D는 2D 및 3D 데이터를 업로드하고, 이를 최적화된 형태로 변환하여 웹 브라우저를 통해 3차원으로 시각화할 수 있는 오픈소스 플랫폼입니다. 다양한 공간 데이터를 손쉽게 관리하고 시각화하는 기능을 제공하여 도시 계획, 시설 관리, 재난 관리 등 여러 분야에서 활용될 수 있습니다.

주요목적은 다음과 같습니다.

* 데이터의 통합 시각화: 2D 및 3D 공간 데이터를 웹 환경에서 통합적으로 시각화하여 복잡한 정보를 직관적으로 이해할 수 있게 합니다.
* 데이터 최적화 및 변환: 사용자가 업로드한 원본 데이터를 웹 환경에서 효율적으로 렌더링할 수 있도록 최적화된 3D 형식으로 변환합니다.

mago3D API는 사용자가 데이터를 업로드, 관리 및 시각화하는 데 필요한 다양한 기능을 제공합니다.  
API는 크게 `세 가지` 어플리케이션으로 구성되어 있으며, 각 어플리케이션은 특정한 기능을 담당합니다:

#### Dataset Application
* 데이터 그룹 관리: 그룹 추가, 수정, 삭제, 목록 조회 및 그룹별 데이터 조회 기능 제공
* 데이터 관리: 2D/3D 데이터 업로드, 데이터 목록 조회, 검색, 수정 및 삭제 기능을 제공
* 데이터 변환: 업로드된 데이터를 웹 환경에서 효과적으로 렌더링할 수 있도록 최적화된 형식으로 변환

#### Layerset Application
* 레이어 그룹 관리: 그룹 추가, 수정, 삭제 및 그룹별 레이어 조회 기능 제공
* 레이어 관리: 레이어 등록, 수정, 삭제 및 레이어 권한(공개/비공개), 켜짐여부(켜짐/꺼짐), 사용여부(사용/미사용) 설정 기능 제공 
* 레이어 미리보기: 변환된 레이어의 미리볼 수 있는 기능 제공
* 레이어 스타일: 벡터 레이어의 점, 선, 면, 속성별 스타일 관리기능 제공

#### Userset Application
* 사용자 관리: 사용자 계정 생성, 수정, 삭제, 조회와 같은 기본적인 사용자 관리 기능 제공
* 권한 관리: 각 사용자 그룹에 대한 접속 권한 설정 기능 제공

### GraphQL API
GraphQL은 API를 위한 데이터 쿼리 언어로, 클라이언트가 필요한 데이터를 정확하게 요청하고 받을 수 있는 방식입니다. REST API와 달리, 여러 엔드포인트를 사용하지 않고 하나의 엔드포인트에서 다양한 데이터 요청을 처리할 수 있습니다. 이를 통해 불필요한 데이터 전송을 줄이고 효율적인 데이터 통신을 가능하게 합니다.

#### 1. 스키마 (Schema)

* 스키마는 GraphQL 서버의 데이터 구조를 정의하는 역할을 합니다. 스키마는 어떤 데이터가 존재하고, 그 데이터들 간의 관계가 무엇인지, 그리고 클라이언트가 어떤 요청을 할 수 있는지를 명확히 설명합니다.
* 스키마에는 타입(Types), 쿼리(Queries), 뮤테이션(Mutations)이 포함되어 있으며, 이 스키마를 바탕으로 클라이언트는 어떤 데이터를 요청할 수 있는지 알 수 있습니다.

#### 2. 쿼리 (Queries)

* 쿼리는 클라이언트가 데이터를 읽기 위해 서버에 요청을 보내는 방식입니다. 예를 들어, 특정 사용자의 정보를 요청할 때 쿼리를 사용합니다.
* REST에서 GET 요청과 유사하지만, 필요한 데이터 필드만 선택하여 요청할 수 있습니다. 예를 들어, 사용자의 이름과 이메일만 요청할 수 있습니다.
쿼리 예시
```graphql
query {
  user(id: 1) {
    name
    email
  }
}
```
이 쿼리는 ID가 1인 사용자의 이름과 이메일만 요청하는 예시입니다.

#### 3. 뮤테이션 (Mutations)

* 뮤테이션은 서버의 데이터를 생성(Create), 수정(Update), 삭제(Delete)할 때 사용됩니다. REST의 POST, PUT, DELETE와 비슷한 개념입니다.
* 뮤테이션을 통해 데이터베이스에 변경이 일어난 후, 요청한 클라이언트에게 변경된 데이터가 반환될 수 있습니다.
뮤테이션 예시
```graphql
mutation {
  createUser(name: "John", email: "john@example.com") {
    id
    name
  }
}
```
이 뮤테이션은 새로운 사용자를 생성하고, 생성된 사용자의 ID와 이름을 반환합니다.

#### 4. 타입 (Type)

* GraphQL의 모든 데이터는 타입으로 정의됩니다. 타입은 스키마에서 데이터를 어떻게 구성할지 나타내며, 각 타입은 필드를 가지며 필드마다 데이터 유형이 있습니다.
* 예를 들어, User 타입은 사용자의 ID, 이름, 이메일 등의 필드를 가질 수 있습니다.
타입 예시
```graphql
type User {
  id: ID
  name: String
  email: String
}
```
이 타입 정의는 사용자 객체가 ID, 이름, 이메일 필드를 가지고 있음을 나타냅니다.

#### 5. 필드 (Field)

* GraphQL 쿼리에서 필드는 데이터를 요청하는 단위입니다. 클라이언트는 필요한 필드만 선택적으로 요청할 수 있으며, 서버는 선택된 필드만 반환합니다. 이를 통해 불필요한 데이터를 주고받지 않게 됩니다.

#### 6. 필터링, 페이징, 정렬

* GraphQL은 클라이언트가 쿼리 시 다양한 조건을 걸어 데이터를 필터링하거나 페이징(페이지 단위로 데이터를 나눠서 요청), 정렬 등을 할 수 있는 유연성을 제공합니다.

#### GraphQL의 장점
* 효율적인 데이터 전송: 클라이언트는 필요한 데이터만 정확하게 요청할 수 있기 때문에, 불필요한 데이터 전송을 줄일 수 있습니다.
* 하나의 엔드포인트: REST API와 달리 여러 엔드포인트를 사용하지 않고, 하나의 엔드포인트에서 다양한 데이터를 요청할 수 있습니다.
* 타입 시스템: 스키마를 통해 API의 구조가 명확히 정의되어 있어, 요청하는 데이터의 타입을 쉽게 이해할 수 있으며, 개발 중에 오류를 줄일 수 있습니다.

## 시작하기(Getting Started)

* API 엔드포인트: GraphQL API의 엔드포인트 URL을 명시합니다.
* 인증 방법: API 사용 시 필요한 인증 방식은 JWT 토큰 방식 입니다, 예제 요청은 다음과 같습니다:
* 요청 및 응답 형식: GraphQL 쿼리 및 뮤테이션의 요청 형식과 서버로부터 받는 응답 형식에 대해 설명합니다.

## 스키마 개요 (Schema Overview)

* 타입 (Types): GraphQL에서 사용하는 주요 타입을 정의하고, 각 타입의 필드를 설명합니다. 예를 들어, User, Building, Model 등과 같은 타입을 설명합니다.
* 쿼리 (Queries): 사용자가 데이터를 읽을 수 있는 쿼리 목록을 나열하고, 각 쿼리의 목적과 반환 데이터 타입을 설명합니다.
* 뮤테이션 (Mutations): 데이터를 생성, 업데이트, 삭제하는 방법을 설명합니다. 각 뮤테이션의 예제와 설명, 그리고 성공 및 실패 시 응답 형식을 제공합니다.

## 예제 (Examples)
* 기본 예제: 간단한 예제를 통해 사용자에게 기본적인 GraphQL 쿼리와 뮤테이션을 익힐 수 있도록 합니다. 예를 들어, 특정 사용자를 가져오는 쿼리, 모델을 생성하는 뮤테이션 등을 제공합니다.
* 고급 예제: 필터링, 페이징, 정렬과 같은 고급 기능을 다룬 예제를 포함합니다.

